!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react/jsx-runtime"),require("react")):"function"==typeof define&&define.amd?define(["exports","react/jsx-runtime","react"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).Kairos={},e.jsxRuntime,e.React)}(this,function(e,n,t){"use strict";class a{constructor(){this.provider="MERCADOPAGO",this.mp=null,this.bricksBuilder=null,this.cardPaymentBrick=null,this.publicKey=""}async loadScript(){if(!window.MercadoPago)return new Promise((e,n)=>{const t=document.createElement("script");t.src="https://sdk.mercadopago.com/js/v2",t.async=!0,t.onload=()=>e(),t.onerror=()=>n(new Error("Failed to load MercadoPago SDK")),document.head.appendChild(t)})}async init(e,n){this.publicKey=e,await this.loadScript(),this.mp=new window.MercadoPago(e,{locale:n?.locale||"pt-BR"}),this.bricksBuilder=this.mp.bricks()}async createCardPayment(e,n){const t="string"==typeof e?e.replace("#",""):e.id;this.cardPaymentBrick&&await this.cardPaymentBrick.unmount();const a={initialization:{amount:n.amount,payer:{email:""}},customization:{visual:{style:{customVariables:{formBackgroundColor:n.styles?.primaryColor||"#ffffff",baseColor:n.styles?.primaryColor||"#1a1a1a"}}},paymentMethods:{maxInstallments:n.maxInstallments||12}},callbacks:{onReady:()=>{n.onReady?.()},onSubmit:async e=>{const t={token:e.token,installments:e.installments,paymentMethodId:e.payment_method_id,issuerId:e.issuer_id,lastFourDigits:e.last_four_digits||"",cardholderName:e.cardholder?.name||"",provider:this.provider};await n.onSubmit(t)},onError:e=>{n.onError?.({code:e.type||"UNKNOWN",message:e.message||"An error occurred",cause:e})}}};return this.cardPaymentBrick=await this.bricksBuilder.create("cardPayment",t,a),{updateAmount:e=>{console.warn("MercadoPago Bricks does not support dynamic amount update")},submit:async()=>{throw new Error("Use form submission instead")},unmount:()=>{this.cardPaymentBrick?.unmount(),this.cardPaymentBrick=null}}}async getInstallments(e,n){const t=await this.mp.getInstallments({amount:String(e),bin:n});if(!t||0===t.length)return[];return(t[0].payer_costs||[]).map((e,n)=>({installments:e.installments,installmentAmount:e.installment_amount,totalAmount:e.total_amount,interestFree:0===e.installment_rate,interestRate:e.installment_rate,recommended:0===n}))}destroy(){this.cardPaymentBrick&&(this.cardPaymentBrick.unmount(),this.cardPaymentBrick=null),this.mp=null,this.bricksBuilder=null}}class r{constructor(){this.provider="PAGSEGURO",this.publicKey="",this.environment="sandbox"}async loadScript(){if(window.PagSeguro)return;const e="production"===this.environment?"https://assets.pagseguro.com.br/checkout-sdk-js/rc/dist/browser/pagseguro.min.js":"https://stc.sandbox.pagseguro.uol.com.br/pagseguro/api/v2/checkout/pagseguro.directpayment.js";return new Promise((n,t)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onload=()=>n(),a.onerror=()=>t(new Error("Failed to load PagSeguro SDK")),document.head.appendChild(a)})}async init(e,n){this.publicKey=e,this.environment=n?.environment||"sandbox",await this.loadScript()}async createCardPayment(e,n){const t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Error(`Container not found: ${e}`);const a=this.createFormHtml(n);t.innerHTML=a;const r=t.querySelector("form");return r.addEventListener("submit",async e=>{e.preventDefault();try{const e=new FormData(r),t={token:await this.tokenizeCard(e),installments:parseInt(e.get("installments"))||1,paymentMethodId:"credit_card",issuerId:"",lastFourDigits:e.get("cardNumber")?.slice(-4)||"",cardholderName:e.get("cardholderName")||"",provider:this.provider};await n.onSubmit(t)}catch(e){n.onError?.({code:"TOKENIZATION_ERROR",message:e.message||"Failed to tokenize card",cause:e})}}),n.onReady?.(),{updateAmount:e=>{const n=r.querySelector("[data-amount]");n&&(n.textContent=`R$ ${e.toFixed(2)}`)},submit:async()=>(r.dispatchEvent(new Event("submit")),{}),unmount:()=>{t.innerHTML=""}}}createFormHtml(e){return`\n      <form class="kairos-card-form" data-kairos-form>\n        <div class="kairos-field">\n          <label for="cardNumber">Numero do Cartao</label>\n          <input type="text" id="cardNumber" name="cardNumber"\n                 placeholder="0000 0000 0000 0000"\n                 maxlength="19" required />\n        </div>\n\n        <div class="kairos-field-row">\n          <div class="kairos-field">\n            <label for="expiry">Validade</label>\n            <input type="text" id="expiry" name="expiry"\n                   placeholder="MM/AA" maxlength="5" required />\n          </div>\n          <div class="kairos-field">\n            <label for="cvv">CVV</label>\n            <input type="text" id="cvv" name="cvv"\n                   placeholder="123" maxlength="4" required />\n          </div>\n        </div>\n\n        <div class="kairos-field">\n          <label for="cardholderName">Nome no Cartao</label>\n          <input type="text" id="cardholderName" name="cardholderName"\n                 placeholder="NOME COMO NO CARTAO" required />\n        </div>\n\n        ${!1!==e.showInstallments?`\n        <div class="kairos-field">\n          <label for="installments">Parcelas</label>\n          <select id="installments" name="installments">\n            <option value="1">1x de R$ ${e.amount.toFixed(2)}</option>\n          </select>\n        </div>\n        `:""}\n\n        <button type="submit" class="kairos-submit-btn">\n          Pagar <span data-amount>R$ ${e.amount.toFixed(2)}</span>\n        </button>\n      </form>\n    `}async tokenizeCard(e){const n=e.get("cardNumber")?.replace(/\s/g,""),[t,a]=e.get("expiry")?.split("/")||[],r=e.get("cvv"),i=e.get("cardholderName"),o=await fetch("https://api.pagseguro.com/public-keys/card",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.publicKey},body:JSON.stringify({card:{number:n,exp_month:t,exp_year:`20${a}`,security_code:r,holder:{name:i}}})});if(!o.ok)throw new Error("Failed to tokenize card with PagSeguro");return(await o.json()).encrypted}async getInstallments(e,n){const t=[];for(let n=1;n<=12;n++){const a=n<=3,r=a?0:.0199,i=a?e:e*Math.pow(1+r,n),o=i/n;o>=5&&t.push({installments:n,installmentAmount:Math.round(100*o)/100,totalAmount:Math.round(100*i)/100,interestFree:a,interestRate:a?0:100*r,recommended:1===n})}return t}destroy(){}}let i=null,o=0;async function s(e,n){const t=Date.now();if(i&&t-o<18e5)return i;const a=await fetch(`${e}/api/v1/tokenization/${n}/encryption-key`);if(!a.ok)throw new Error(`Failed to fetch encryption key: ${a.status}`);const r=(await a.json()).publicKey,s=atob(r),c=new Uint8Array(s.length);for(let e=0;e<s.length;e++)c[e]=s.charCodeAt(e);return i=await crypto.subtle.importKey("spki",c.buffer,{name:"RSA-OAEP",hash:"SHA-256"},!1,["wrapKey"]),o=t,i}async function c(e,n,t){const a=await s(n,t),r=JSON.stringify({n:e.number,h:e.holderName,m:e.expirationMonth,y:e.expirationYear,c:e.cvv}),i=(new TextEncoder).encode(r),o=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt"]),c=crypto.getRandomValues(new Uint8Array(12)),d=await crypto.subtle.encrypt({name:"AES-GCM",iv:c,tagLength:128},o,i),p=await crypto.subtle.wrapKey("raw",o,a,{name:"RSA-OAEP"}),u=JSON.stringify({ek:l(p),iv:l(c.buffer),d:l(d)});return btoa(u)}function l(e){const n=new Uint8Array(e);let t="";for(let e=0;e<n.length;e++)t+=String.fromCharCode(n[e]);return btoa(t)}class d{constructor(){this.provider="KAIROS",this.apiUrl="",this.tenantId=""}async init(e,n){this.apiUrl=n?.apiUrl||"https://api.kairoshub.tech",this.tenantId=n?.tenantId||""}async createCardPayment(e,n){const t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Error(`Container not found: ${e}`);t.innerHTML=this.buildFormHtml(n);const a=t.querySelector("[data-kairos-enc-form]"),r=t.querySelector("[data-kairos-enc-error]"),i=t.querySelector("[data-kairos-enc-submit]"),o=t.querySelector("[data-kairos-enc-card-number]"),s=t.querySelector("[data-kairos-enc-expiry]"),l=t.querySelector("[data-kairos-enc-cvv]"),d=t.querySelector("[data-kairos-enc-name]"),u=t.querySelector("[data-kairos-enc-installments]"),m=t.querySelector("[data-kairos-enc-brand]");if(o.addEventListener("input",()=>{const e=o.value.replace(/\D/g,"").slice(0,16);o.value=e.replace(/(\d{4})(?=\d)/g,"$1 ");const n=p(e);m&&(m.textContent=n?n.toUpperCase():"",m.style.display=n?"block":"none")}),s.addEventListener("input",()=>{const e=s.value.replace(/\D/g,"").slice(0,4);e.length>=3?s.value=`${e.slice(0,2)}/${e.slice(2)}`:s.value=e}),l.addEventListener("input",()=>{l.value=l.value.replace(/\D/g,"").slice(0,4)}),d.addEventListener("input",()=>{d.value=d.value.toUpperCase()}),u){const e=(await this.getInstallments(n.amount,"")).filter(e=>e.installments<=(n.maxInstallments||12));u.innerHTML=e.map(e=>{const n=e.installmentAmount.toFixed(2).replace(".",","),t=e.interestFree?" sem juros":` (Total: R$ ${e.totalAmount.toFixed(2).replace(".",",")})`;return`<option value="${e.installments}">${e.installments}x de R$ ${n}${t}</option>`}).join("")}return a.addEventListener("submit",async e=>{if(e.preventDefault(),i.disabled)return;const t=this.validate(o.value,s.value,l.value,d.value);if(t)return r.textContent=t,r.style.display="block",void n.onError?.({code:"VALIDATION_ERROR",message:t});r.style.display="none",i.disabled=!0;const a=i.innerHTML;i.innerHTML=this.getLoadingButtonHtml();try{const e=o.value.replace(/\D/g,""),[t,a]=s.value.split("/"),r=(2e3+parseInt(a||"0",10)).toString(),i={token:"",encryptedData:await c({number:e,holderName:d.value.trim(),expirationMonth:t,expirationYear:r,cvv:l.value},this.apiUrl,this.tenantId),installments:u?parseInt(u.value):1,paymentMethodId:p(e)||"unknown",issuerId:"",lastFourDigits:e.slice(-4),cardholderName:d.value.trim(),provider:this.provider};await n.onSubmit(i)}catch(e){r.textContent=e.message||"Erro ao processar pagamento",r.style.display="block",n.onError?.({code:"ENCRYPTION_ERROR",message:e.message||"Failed to encrypt card data",cause:e})}finally{i.disabled=!1,i.innerHTML=a}}),n.onReady?.(),{updateAmount:e=>{const n=t.querySelector("[data-kairos-enc-amount]");n&&(n.textContent=`R$ ${e.toFixed(2).replace(".",",")}`)},submit:async()=>(a.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0})),{}),unmount:()=>{t.innerHTML=""}}}async getInstallments(e,n){const t=[];for(let n=1;n<=12;n++){const a=n<=3,r=a?0:.0199,i=a?e:e*Math.pow(1+r,n),o=i/n;o>=5&&t.push({installments:n,installmentAmount:Math.round(100*o)/100,totalAmount:Math.round(100*i)/100,interestFree:a,interestRate:a?0:100*r,recommended:1===n})}return t}destroy(){}validate(e,n,t,a){if(e.replace(/\D/g,"").length<13)return"Numero do cartao invalido";if(n.length<5)return"Data de validade invalida";const[r,i]=n.split("/"),o=parseInt(r,10);if(o<1||o>12)return"Mes invalido";const s=2e3+parseInt(i||"0",10),c=new Date;return s<c.getFullYear()||s===c.getFullYear()&&o<c.getMonth()+1?"Cartao expirado":t.length<3?"CVV invalido":a.trim().length<3?"Nome invalido":null}getLoadingButtonHtml(){return'\n      <svg class="kairos-enc-spinner" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-dasharray="32" stroke-dashoffset="32">\n          <animate attributeName="stroke-dashoffset" values="32;0;32" dur="1.2s" repeatCount="indefinite"/>\n          <animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="0.8s" repeatCount="indefinite"/>\n        </circle>\n      </svg>\n      <span>Criptografando...</span>\n    '}buildFormHtml(e){const n=e.amount.toFixed(2).replace(".",",");return`\n      <style>\n        .kairos-enc-form {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n          display: flex;\n          flex-direction: column;\n          gap: 16px;\n        }\n        .kairos-enc-field {\n          display: flex;\n          flex-direction: column;\n          gap: 6px;\n        }\n        .kairos-enc-field label {\n          font-size: 13px;\n          font-weight: 500;\n          color: #374151;\n        }\n        .kairos-enc-field input,\n        .kairos-enc-field select {\n          height: 44px;\n          padding: 0 12px;\n          border: 1px solid #d1d5db;\n          border-radius: 8px;\n          font-size: 15px;\n          color: #111827;\n          background: #fff;\n          outline: none;\n          transition: border-color 0.15s, box-shadow 0.15s;\n          -webkit-appearance: none;\n        }\n        .kairos-enc-field input:focus,\n        .kairos-enc-field select:focus {\n          border-color: #7c3aed;\n          box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);\n        }\n        .kairos-enc-field input::placeholder {\n          color: #9ca3af;\n        }\n        .kairos-enc-row {\n          display: grid;\n          grid-template-columns: 1fr 1fr;\n          gap: 12px;\n        }\n        .kairos-enc-card-number-wrapper {\n          position: relative;\n        }\n        .kairos-enc-brand {\n          position: absolute;\n          right: 12px;\n          top: 50%;\n          transform: translateY(-50%);\n          font-size: 11px;\n          font-weight: 700;\n          color: #6b7280;\n          letter-spacing: 0.05em;\n          display: none;\n        }\n        .kairos-enc-error {\n          display: none;\n          padding: 10px 14px;\n          background: #fef2f2;\n          border: 1px solid #fecaca;\n          border-radius: 8px;\n          color: #dc2626;\n          font-size: 13px;\n        }\n        .kairos-enc-security {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          padding: 12px 14px;\n          background: linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%);\n          border: 1px solid rgba(16, 185, 129, 0.2);\n          border-radius: 10px;\n        }\n        .kairos-enc-security-icon {\n          flex-shrink: 0;\n          width: 28px;\n          height: 28px;\n          color: #059669;\n        }\n        .kairos-enc-security-text {\n          flex: 1;\n        }\n        .kairos-enc-security-text strong {\n          display: block;\n          font-size: 13px;\n          font-weight: 600;\n          color: #065f46;\n        }\n        .kairos-enc-security-text span {\n          font-size: 11px;\n          color: #047857;\n          opacity: 0.8;\n        }\n        .kairos-enc-security-badge {\n          display: flex;\n          align-items: center;\n          gap: 4px;\n          flex-shrink: 0;\n        }\n        .kairos-enc-security-badge svg {\n          width: 12px;\n          height: 12px;\n          color: #10b981;\n        }\n        .kairos-enc-security-badge span {\n          font-size: 9px;\n          font-weight: 800;\n          color: #047857;\n          letter-spacing: 0.12em;\n        }\n        .kairos-enc-submit {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 8px;\n          width: 100%;\n          height: 52px;\n          border: none;\n          border-radius: 10px;\n          font-size: 16px;\n          font-weight: 600;\n          color: #fff;\n          background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%);\n          cursor: pointer;\n          transition: opacity 0.15s, transform 0.1s;\n        }\n        .kairos-enc-submit:hover:not(:disabled) {\n          opacity: 0.92;\n        }\n        .kairos-enc-submit:active:not(:disabled) {\n          transform: scale(0.98);\n        }\n        .kairos-enc-submit:disabled {\n          opacity: 0.6;\n          cursor: not-allowed;\n        }\n        .kairos-enc-submit svg {\n          width: 20px;\n          height: 20px;\n        }\n        .kairos-enc-spinner {\n          animation: kairos-enc-spin 0.8s linear infinite;\n        }\n        @keyframes kairos-enc-spin {\n          to { transform: rotate(360deg); }\n        }\n        @media (prefers-color-scheme: dark) {\n          .kairos-enc-field label { color: #d1d5db; }\n          .kairos-enc-field input,\n          .kairos-enc-field select {\n            background: #1f2937;\n            border-color: #374151;\n            color: #f3f4f6;\n          }\n          .kairos-enc-field input:focus,\n          .kairos-enc-field select:focus {\n            border-color: #8b5cf6;\n            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.15);\n          }\n          .kairos-enc-field input::placeholder { color: #6b7280; }\n          .kairos-enc-brand { color: #9ca3af; }\n          .kairos-enc-error {\n            background: #451a1a;\n            border-color: #7f1d1d;\n            color: #fca5a5;\n          }\n          .kairos-enc-security {\n            background: linear-gradient(135deg, #064e3b20 0%, #06543420 100%);\n            border-color: rgba(16, 185, 129, 0.15);\n          }\n          .kairos-enc-security-text strong { color: #6ee7b7; }\n          .kairos-enc-security-text span { color: #34d399; }\n          .kairos-enc-security-badge span { color: #6ee7b7; }\n        }\n      </style>\n\n      <form class="kairos-enc-form" data-kairos-enc-form>\n        <div data-kairos-enc-error class="kairos-enc-error"></div>\n\n        <div class="kairos-enc-field">\n          <label>Numero do Cartao</label>\n          <div class="kairos-enc-card-number-wrapper">\n            <input\n              type="text"\n              inputmode="numeric"\n              placeholder="0000 0000 0000 0000"\n              maxlength="19"\n              autocomplete="cc-number"\n              data-kairos-enc-card-number\n            />\n            <span class="kairos-enc-brand" data-kairos-enc-brand></span>\n          </div>\n        </div>\n\n        <div class="kairos-enc-row">\n          <div class="kairos-enc-field">\n            <label>Validade</label>\n            <input\n              type="text"\n              inputmode="numeric"\n              placeholder="MM/AA"\n              maxlength="5"\n              autocomplete="cc-exp"\n              data-kairos-enc-expiry\n            />\n          </div>\n          <div class="kairos-enc-field">\n            <label>CVV</label>\n            <input\n              type="text"\n              inputmode="numeric"\n              placeholder="123"\n              maxlength="4"\n              autocomplete="cc-csc"\n              data-kairos-enc-cvv\n            />\n          </div>\n        </div>\n\n        <div class="kairos-enc-field">\n          <label>Nome no Cartao</label>\n          <input\n            type="text"\n            placeholder="NOME COMO NO CARTAO"\n            autocomplete="cc-name"\n            data-kairos-enc-name\n          />\n        </div>\n\n        ${!1!==e.showInstallments?`\n        <div class="kairos-enc-field">\n          <label>Parcelas</label>\n          <select data-kairos-enc-installments>\n            <option value="1">1x de R$ ${n} sem juros</option>\n          </select>\n        </div>\n        `:""}\n\n        <div class="kairos-enc-security">\n          <svg class="kairos-enc-security-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>\n            <path d="m9 12 2 2 4-4"/>\n          </svg>\n          <div class="kairos-enc-security-text">\n            <strong>Pagamento Seguro</strong>\n            <span>Dados criptografados de ponta a ponta via Kairos Payment Hub</span>\n          </div>\n          <div class="kairos-enc-security-badge">\n            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">\n              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>\n              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>\n            </svg>\n            <span>KAIROS</span>\n          </div>\n        </div>\n\n        <button type="submit" class="kairos-enc-submit" data-kairos-enc-submit>\n          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>\n            <line x1="1" y1="10" x2="23" y2="10"/>\n          </svg>\n          <span>Pagar <span data-kairos-enc-amount>R$ ${n}</span></span>\n        </button>\n      </form>\n    `}}function p(e){const n=e.replace(/\D/g,"");return/^4/.test(n)?"visa":/^5[1-5]/.test(n)?"mastercard":/^3[47]/.test(n)?"amex":/^(636368|438935|504175|451416|636297)/.test(n)||/^(5067|4576|4011)/.test(n)?"elo":/^606282/.test(n)?"hipercard":""}class u{constructor(e){this.options=[],this.adapter=null,this.cardInstance=null,this.config={tenantId:e.tenantId,environment:e.environment||"production",apiUrl:e.apiUrl||"https://api.kairoshub.tech",preferredProvider:e.preferredProvider||void 0,locale:e.locale||"pt-BR",debug:e.debug||!1}}static async init(e){const n=new u(e);return await n.fetchOptions(),n}async fetchOptions(){const e=`${this.config.apiUrl}/api/v1/tokenization/${this.config.tenantId}/options`;this.log("Fetching tokenization options from",e);try{const n=await fetch(e);if(!n.ok)return this.log("Failed to fetch tokenization options:",n.status),void(this.options=[]);const t=await n.json();this.options=t.options||[],this.log("Available PSPs:",this.options.map(e=>e.provider))}catch(e){this.log("Error fetching tokenization options, will use Kairos encryption:",e),this.options=[]}}async getAdapter(){if(this.adapter)return this.adapter;if("KAIROS"===this.config.preferredProvider)return this.log("Using Kairos Encrypted adapter (preferred)"),this.initKairosAdapter();let e=this.options[0];if(this.config.preferredProvider){const n=this.options.find(e=>e.provider===this.config.preferredProvider);n&&(e=n)}if(!e)return this.log("No PSP with client-side tokenization available, falling back to Kairos encryption"),this.initKairosAdapter();switch(this.log("Using PSP:",e.provider),e.provider){case"MERCADOPAGO":this.adapter=new a;break;case"PAGSEGURO":this.adapter=new r;break;default:return this.log(`Unknown PSP provider "${e.provider}", falling back to Kairos encryption`),this.initKairosAdapter()}return await this.adapter.init(e.publicKey,{locale:this.config.locale,environment:e.environment}),this.adapter}async initKairosAdapter(){return this.adapter=new d,await this.adapter.init("",{apiUrl:this.config.apiUrl,tenantId:this.config.tenantId,locale:this.config.locale}),this.adapter}async createCardPayment(e,n){const t=await this.getAdapter();return this.log("Creating card payment form with amount:",n.amount),this.cardInstance=await t.createCardPayment(e,n),this.cardInstance}async getInstallments(e,n){return(await this.getAdapter()).getInstallments(e,n)}getAvailableProviders(){return[...this.options]}getConfig(){return{...this.config}}destroy(){this.cardInstance&&(this.cardInstance.unmount(),this.cardInstance=null),this.adapter&&(this.adapter.destroy(),this.adapter=null),this.options=[]}log(...e){this.config.debug&&console.log("[Kairos]",...e)}}const m={display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 0 4px",opacity:.6},h={fontSize:"11px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:"#6b7280",letterSpacing:"0.02em"};function f(){return n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("path",{d:"M12 2L2 7v10l10 5 10-5V7L12 2z",stroke:"#6b7280",strokeWidth:"1.5",strokeLinejoin:"round"}),n.jsx("path",{d:"M12 7v10M8 9l4 3 4-3M8 15l4-3 4 3",stroke:"#6b7280",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}e.CardPaymentForm=function({tenantId:e,amount:a,environment:r="production",apiUrl:i,preferredProvider:o,maxInstallments:s=12,onSuccess:c,onError:l,onReady:d,className:p,debug:y=!1}){const g=t.useRef(null),b=t.useRef(null),[k,v]=t.useState(!0),[x,w]=t.useState(null);return t.useEffect(()=>{let n=!0;return async function(){if(g.current)try{v(!0),w(null);const t={tenantId:e,environment:r,apiUrl:i,preferredProvider:o,debug:y},p=await u.init(t);if(!n)return void p.destroy();b.current=p;const m={amount:a,maxInstallments:s,onReady:()=>{v(!1),d?.()},onSubmit:async e=>{c(e)},onError:e=>{w(e.message),l?.(e)}};await p.createCardPayment(g.current,m)}catch(e){if(n){const n=e.message||"Failed to initialize payment form";w(n),v(!1),l?.({code:"INIT_ERROR",message:n,cause:e})}}}(),()=>{n=!1,b.current&&(b.current.destroy(),b.current=null)}},[e,a,r,i,o]),n.jsxs("div",{className:p,children:[k&&n.jsxs("div",{className:"kairos-loading",children:[n.jsx("div",{className:"kairos-spinner"}),n.jsx("span",{children:"Carregando formulario de pagamento..."})]}),x&&n.jsx("div",{className:"kairos-error",children:n.jsx("span",{children:x})}),n.jsx("div",{ref:g,id:"kairos-card-payment-container",style:{display:k?"none":"block"}}),!k&&!x&&n.jsxs("div",{className:"kairos-branding",style:m,children:[n.jsx(f,{}),n.jsx("span",{style:h,children:"Powered by Kairos"})]})]})},e.KairosEncryptedAdapter=d,e.KairosPayments=u,e.VERSION="0.1.0",e.clearEncryptionCache=function(){i=null,o=0},e.encryptCardData=c,e.isEncryptionAvailable=async function(e,n){try{return await s(e,n),!0}catch{return!1}}});
//# sourceMappingURL=kairos.min.js.map
