!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react/jsx-runtime"),require("react")):"function"==typeof define&&define.amd?define(["exports","react/jsx-runtime","react"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).Kairos={},e.jsxRuntime,e.React)}(this,function(e,n,t){"use strict";class r{constructor(){this.provider="MERCADOPAGO",this.mp=null,this.bricksBuilder=null,this.cardPaymentBrick=null,this.publicKey=""}async loadScript(){if(!window.MercadoPago)return new Promise((e,n)=>{const t=document.createElement("script");t.src="https://sdk.mercadopago.com/js/v2",t.async=!0,t.onload=()=>e(),t.onerror=()=>n(new Error("Failed to load MercadoPago SDK")),document.head.appendChild(t)})}async init(e,n){this.publicKey=e,await this.loadScript(),this.mp=new window.MercadoPago(e,{locale:n?.locale||"pt-BR"}),this.bricksBuilder=this.mp.bricks()}async createCardPayment(e,n){const t="string"==typeof e?e.replace("#",""):e.id;this.cardPaymentBrick&&await this.cardPaymentBrick.unmount();const r={initialization:{amount:n.amount,payer:{email:""}},customization:{visual:{style:{customVariables:{formBackgroundColor:n.styles?.primaryColor||"#ffffff",baseColor:n.styles?.primaryColor||"#1a1a1a"}}},paymentMethods:{maxInstallments:n.maxInstallments||12}},callbacks:{onReady:()=>{n.onReady?.()},onSubmit:async e=>{const t={token:e.token,installments:e.installments,paymentMethodId:e.payment_method_id,issuerId:e.issuer_id,lastFourDigits:e.last_four_digits||"",cardholderName:e.cardholder?.name||"",provider:this.provider};await n.onSubmit(t)},onError:e=>{n.onError?.({code:e.type||"UNKNOWN",message:e.message||"An error occurred",cause:e})}}};return this.cardPaymentBrick=await this.bricksBuilder.create("cardPayment",t,r),{updateAmount:e=>{console.warn("MercadoPago Bricks does not support dynamic amount update")},submit:async()=>{throw new Error("Use form submission instead")},unmount:()=>{this.cardPaymentBrick?.unmount(),this.cardPaymentBrick=null}}}async getInstallments(e,n){const t=await this.mp.getInstallments({amount:String(e),bin:n});if(!t||0===t.length)return[];return(t[0].payer_costs||[]).map((e,n)=>({installments:e.installments,installmentAmount:e.installment_amount,totalAmount:e.total_amount,interestFree:0===e.installment_rate,interestRate:e.installment_rate,recommended:0===n}))}destroy(){this.cardPaymentBrick&&(this.cardPaymentBrick.unmount(),this.cardPaymentBrick=null),this.mp=null,this.bricksBuilder=null}}class a{constructor(){this.provider="PAGSEGURO",this.publicKey="",this.environment="sandbox"}async loadScript(){if(window.PagSeguro)return;const e="production"===this.environment?"https://assets.pagseguro.com.br/checkout-sdk-js/rc/dist/browser/pagseguro.min.js":"https://stc.sandbox.pagseguro.uol.com.br/pagseguro/api/v2/checkout/pagseguro.directpayment.js";return new Promise((n,t)=>{const r=document.createElement("script");r.src=e,r.async=!0,r.onload=()=>n(),r.onerror=()=>t(new Error("Failed to load PagSeguro SDK")),document.head.appendChild(r)})}async init(e,n){this.publicKey=e,this.environment=n?.environment||"sandbox",await this.loadScript()}async createCardPayment(e,n){const t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Error(`Container not found: ${e}`);const r=this.createFormHtml(n);t.innerHTML=r;const a=t.querySelector("form");return a.addEventListener("submit",async e=>{e.preventDefault();try{const e=new FormData(a),t={token:await this.tokenizeCard(e),installments:parseInt(e.get("installments"))||1,paymentMethodId:"credit_card",issuerId:"",lastFourDigits:e.get("cardNumber")?.slice(-4)||"",cardholderName:e.get("cardholderName")||"",provider:this.provider};await n.onSubmit(t)}catch(e){n.onError?.({code:"TOKENIZATION_ERROR",message:e.message||"Failed to tokenize card",cause:e})}}),n.onReady?.(),{updateAmount:e=>{const n=a.querySelector("[data-amount]");n&&(n.textContent=`R$ ${e.toFixed(2)}`)},submit:async()=>(a.dispatchEvent(new Event("submit")),{}),unmount:()=>{t.innerHTML=""}}}createFormHtml(e){return`\n      <form class="kairos-card-form" data-kairos-form>\n        <div class="kairos-field">\n          <label for="cardNumber">Numero do Cartao</label>\n          <input type="text" id="cardNumber" name="cardNumber"\n                 placeholder="0000 0000 0000 0000"\n                 maxlength="19" required />\n        </div>\n\n        <div class="kairos-field-row">\n          <div class="kairos-field">\n            <label for="expiry">Validade</label>\n            <input type="text" id="expiry" name="expiry"\n                   placeholder="MM/AA" maxlength="5" required />\n          </div>\n          <div class="kairos-field">\n            <label for="cvv">CVV</label>\n            <input type="text" id="cvv" name="cvv"\n                   placeholder="123" maxlength="4" required />\n          </div>\n        </div>\n\n        <div class="kairos-field">\n          <label for="cardholderName">Nome no Cartao</label>\n          <input type="text" id="cardholderName" name="cardholderName"\n                 placeholder="NOME COMO NO CARTAO" required />\n        </div>\n\n        ${!1!==e.showInstallments?`\n        <div class="kairos-field">\n          <label for="installments">Parcelas</label>\n          <select id="installments" name="installments">\n            <option value="1">1x de R$ ${e.amount.toFixed(2)}</option>\n          </select>\n        </div>\n        `:""}\n\n        <button type="submit" class="kairos-submit-btn">\n          Pagar <span data-amount>R$ ${e.amount.toFixed(2)}</span>\n        </button>\n      </form>\n    `}async tokenizeCard(e){const n=e.get("cardNumber")?.replace(/\s/g,""),[t,r]=e.get("expiry")?.split("/")||[],a=e.get("cvv"),i=e.get("cardholderName"),o=await fetch("https://api.pagseguro.com/public-keys/card",{method:"POST",headers:{"Content-Type":"application/json",Authorization:this.publicKey},body:JSON.stringify({card:{number:n,exp_month:t,exp_year:`20${r}`,security_code:a,holder:{name:i}}})});if(!o.ok)throw new Error("Failed to tokenize card with PagSeguro");return(await o.json()).encrypted}async getInstallments(e,n){const t=[];for(let n=1;n<=12;n++){const r=n<=3,a=r?0:.0199,i=r?e:e*Math.pow(1+a,n),o=i/n;o>=5&&t.push({installments:n,installmentAmount:Math.round(100*o)/100,totalAmount:Math.round(100*i)/100,interestFree:r,interestRate:r?0:100*a,recommended:1===n})}return t}destroy(){}}const i=new Map;async function o(e,n,t){const r=t||"__default__",a=Date.now(),o=i.get(r);if(o&&a-o.timestamp<864e5)return o.key;const s=t?`?merchantId=${t}`:"",c=await fetch(`${e}/api/v1/tokenization/${n}/encryption-key${s}`);if(!c.ok)throw new Error(`Failed to fetch encryption key: ${c.status}`);const l=(await c.json()).publicKey,d=atob(l),u=new Uint8Array(d.length);for(let e=0;e<d.length;e++)u[e]=d.charCodeAt(e);const p=await crypto.subtle.importKey("spki",u.buffer,{name:"RSA-OAEP",hash:"SHA-256"},!1,["wrapKey"]);return i.set(r,{key:p,timestamp:a}),p}async function s(e,n,t,r){const a=await o(n,t,r),i=JSON.stringify({n:e.number,h:e.holderName,m:e.expirationMonth,y:e.expirationYear,c:e.cvv}),s=(new TextEncoder).encode(i),l=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt"]),d=crypto.getRandomValues(new Uint8Array(12)),u=await crypto.subtle.encrypt({name:"AES-GCM",iv:d,tagLength:128},l,s),p=await crypto.subtle.wrapKey("raw",l,a,{name:"RSA-OAEP"}),m=JSON.stringify({ek:c(p),iv:c(d.buffer),d:c(u)});return btoa(m)}function c(e){const n=new Uint8Array(e);let t="";for(let e=0;e<n.length;e++)t+=String.fromCharCode(n[e]);return btoa(t)}class l{constructor(){this.provider="KAIROS",this.apiUrl="",this.tenantId="",this.merchantId=""}async init(e,n){this.apiUrl=n?.apiUrl||"https://api.kairoshub.tech",this.tenantId=n?.tenantId||"",this.merchantId=n?.merchantId||""}async createCardPayment(e,n){const t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Error(`Container not found: ${e}`);t.innerHTML=this.buildFormHtml(n);const r=t.querySelector("[data-kairos-enc-form]"),a=t.querySelector("[data-kairos-enc-error]"),i=t.querySelector("[data-kairos-enc-submit]"),o=t.querySelector("[data-kairos-enc-card-number]"),c=t.querySelector("[data-kairos-enc-expiry]"),l=t.querySelector("[data-kairos-enc-cvv]"),u=t.querySelector("[data-kairos-enc-name]"),p=t.querySelector("[data-kairos-enc-installments]"),m=t.querySelector("[data-kairos-enc-brand]");if(o.addEventListener("input",()=>{const e=o.value.replace(/\D/g,"").slice(0,16);o.value=e.replace(/(\d{4})(?=\d)/g,"$1 ");const n=d(e);m&&(m.textContent=n?n.toUpperCase():"",m.style.display=n?"block":"none")}),c.addEventListener("input",()=>{const e=c.value.replace(/\D/g,"").slice(0,4);e.length>=3?c.value=`${e.slice(0,2)}/${e.slice(2)}`:c.value=e}),l.addEventListener("input",()=>{l.value=l.value.replace(/\D/g,"").slice(0,4)}),u.addEventListener("input",()=>{u.value=u.value.toUpperCase()}),p){const e=(await this.getInstallments(n.amount,"")).filter(e=>e.installments<=(n.maxInstallments||12));p.innerHTML=e.map(e=>{const n=e.installmentAmount.toFixed(2).replace(".",","),t=e.interestFree?" sem juros":` (Total: R$ ${e.totalAmount.toFixed(2).replace(".",",")})`;return`<option value="${e.installments}">${e.installments}x de R$ ${n}${t}</option>`}).join("")}return r.addEventListener("submit",async e=>{if(e.preventDefault(),i.disabled)return;const t=this.validate(o.value,c.value,l.value,u.value);if(t)return a.textContent=t,a.style.display="block",void n.onError?.({code:"VALIDATION_ERROR",message:t});a.style.display="none",i.disabled=!0;const r=i.innerHTML;i.innerHTML=this.getLoadingButtonHtml();try{const e=o.value.replace(/\D/g,""),[t,r]=c.value.split("/"),a=(2e3+parseInt(r||"0",10)).toString(),i={token:"",encryptedData:await s({number:e,holderName:u.value.trim(),expirationMonth:t,expirationYear:a,cvv:l.value},this.apiUrl,this.tenantId,this.merchantId),installments:p?parseInt(p.value):1,paymentMethodId:d(e)||"unknown",issuerId:"",lastFourDigits:e.slice(-4),cardholderName:u.value.trim(),provider:this.provider};await n.onSubmit(i)}catch(e){a.textContent=e.message||"Erro ao processar pagamento",a.style.display="block",n.onError?.({code:"ENCRYPTION_ERROR",message:e.message||"Failed to encrypt card data",cause:e})}finally{i.disabled=!1,i.innerHTML=r}}),n.onReady?.(),{updateAmount:e=>{const n=t.querySelector("[data-kairos-enc-amount]");n&&(n.textContent=`R$ ${e.toFixed(2).replace(".",",")}`)},submit:async()=>(r.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0})),{}),unmount:()=>{t.innerHTML=""}}}async getInstallments(e,n){const t=[];for(let n=1;n<=12;n++){const r=n<=3,a=r?0:.0199,i=r?e:e*Math.pow(1+a,n),o=i/n;o>=5&&t.push({installments:n,installmentAmount:Math.round(100*o)/100,totalAmount:Math.round(100*i)/100,interestFree:r,interestRate:r?0:100*a,recommended:1===n})}return t}destroy(){}validate(e,n,t,r){if(e.replace(/\D/g,"").length<13)return"Numero do cartao invalido";if(n.length<5)return"Data de validade invalida";const[a,i]=n.split("/"),o=parseInt(a,10);if(o<1||o>12)return"Mes invalido";const s=2e3+parseInt(i||"0",10),c=new Date;return s<c.getFullYear()||s===c.getFullYear()&&o<c.getMonth()+1?"Cartao expirado":t.length<3?"CVV invalido":r.trim().length<3?"Nome invalido":null}getLoadingButtonHtml(){return'\n      <svg class="kairos-enc-spinner" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-dasharray="32" stroke-dashoffset="32">\n          <animate attributeName="stroke-dashoffset" values="32;0;32" dur="1.2s" repeatCount="indefinite"/>\n          <animateTransform attributeName="transform" type="rotate" from="0 12 12" to="360 12 12" dur="0.8s" repeatCount="indefinite"/>\n        </circle>\n      </svg>\n      <span>Criptografando...</span>\n    '}buildFormHtml(e){const n=e.amount.toFixed(2).replace(".",",");return`\n      <style>\n        /*\n         * Kairos Payments SDK â€” Card Form Styles\n         *\n         * Override with CSS custom properties on the parent element:\n         *   --kairos-font:        Font family (default: inherit)\n         *   --kairos-text:        Text color (default: inherit)\n         *   --kairos-text-muted:  Muted text / labels (default: inherit with opacity)\n         *   --kairos-bg:          Input background (default: transparent)\n         *   --kairos-border:      Border color (default: currentColor with opacity)\n         *   --kairos-radius:      Border radius (default: 8px)\n         *   --kairos-focus:       Focus ring color (default: #7c3aed)\n         *   --kairos-accent:      Button gradient start (default: #7c3aed)\n         *   --kairos-accent-end:  Button gradient end (default: #9333ea)\n         *   --kairos-success:     Security badge color (default: #059669)\n         */\n        .kairos-enc-form {\n          font-family: var(--kairos-font, inherit);\n          color: var(--kairos-text, inherit);\n          display: flex;\n          flex-direction: column;\n          gap: 16px;\n        }\n        .kairos-enc-field {\n          display: flex;\n          flex-direction: column;\n          gap: 6px;\n        }\n        .kairos-enc-field label {\n          font-size: 13px;\n          font-weight: 500;\n          opacity: 0.7;\n        }\n        .kairos-enc-field input,\n        .kairos-enc-field select {\n          height: 44px;\n          padding: 0 12px;\n          border: 1px solid var(--kairos-border, color-mix(in srgb, currentColor 25%, transparent));\n          border-radius: var(--kairos-radius, 8px);\n          font-size: 15px;\n          font-family: inherit;\n          color: inherit;\n          background: var(--kairos-bg, transparent);\n          outline: none;\n          transition: border-color 0.15s, box-shadow 0.15s;\n          -webkit-appearance: none;\n        }\n        .kairos-enc-field input:focus,\n        .kairos-enc-field select:focus {\n          border-color: var(--kairos-focus, #7c3aed);\n          box-shadow: 0 0 0 3px color-mix(in srgb, var(--kairos-focus, #7c3aed) 15%, transparent);\n        }\n        .kairos-enc-field input::placeholder {\n          color: inherit;\n          opacity: 0.4;\n        }\n        .kairos-enc-row {\n          display: grid;\n          grid-template-columns: 1fr 1fr;\n          gap: 12px;\n        }\n        .kairos-enc-card-number-wrapper {\n          position: relative;\n        }\n        .kairos-enc-brand {\n          position: absolute;\n          right: 12px;\n          top: 50%;\n          transform: translateY(-50%);\n          font-size: 11px;\n          font-weight: 700;\n          opacity: 0.5;\n          letter-spacing: 0.05em;\n          display: none;\n        }\n        .kairos-enc-error {\n          display: none;\n          padding: 10px 14px;\n          background: color-mix(in srgb, #ef4444 10%, transparent);\n          border: 1px solid color-mix(in srgb, #ef4444 25%, transparent);\n          border-radius: var(--kairos-radius, 8px);\n          color: #ef4444;\n          font-size: 13px;\n        }\n        .kairos-enc-security {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          padding: 12px 14px;\n          background: color-mix(in srgb, var(--kairos-success, #059669) 8%, transparent);\n          border: 1px solid color-mix(in srgb, var(--kairos-success, #059669) 20%, transparent);\n          border-radius: var(--kairos-radius, 8px);\n        }\n        .kairos-enc-security-icon {\n          flex-shrink: 0;\n          width: 28px;\n          height: 28px;\n          color: var(--kairos-success, #059669);\n        }\n        .kairos-enc-security-text {\n          flex: 1;\n          min-width: 0;\n        }\n        .kairos-enc-security-text strong {\n          display: block;\n          font-size: 13px;\n          font-weight: 600;\n          color: var(--kairos-success, #059669);\n        }\n        .kairos-enc-security-text span {\n          font-size: 11px;\n          color: var(--kairos-success, #059669);\n          opacity: 0.75;\n        }\n        .kairos-enc-security-badge {\n          display: flex;\n          align-items: center;\n          gap: 5px;\n          flex-shrink: 0;\n          color: var(--kairos-success, #059669);\n          opacity: 0.85;\n        }\n        .kairos-enc-security-badge svg {\n          width: 18px;\n          height: 18px;\n        }\n        .kairos-enc-security-lock {\n          width: 10px;\n          height: 10px;\n          opacity: 0.7;\n        }\n        .kairos-enc-submit {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 8px;\n          width: 100%;\n          height: 52px;\n          border: none;\n          border-radius: var(--kairos-radius, 8px);\n          font-size: 16px;\n          font-weight: 600;\n          font-family: inherit;\n          color: #fff;\n          background: linear-gradient(135deg, var(--kairos-accent, #7c3aed) 0%, var(--kairos-accent-end, #9333ea) 100%);\n          cursor: pointer;\n          transition: opacity 0.15s, transform 0.1s;\n        }\n        .kairos-enc-submit:hover:not(:disabled) {\n          opacity: 0.92;\n        }\n        .kairos-enc-submit:active:not(:disabled) {\n          transform: scale(0.98);\n        }\n        .kairos-enc-submit:disabled {\n          opacity: 0.6;\n          cursor: not-allowed;\n        }\n        .kairos-enc-submit svg {\n          width: 20px;\n          height: 20px;\n        }\n        .kairos-enc-spinner {\n          animation: kairos-enc-spin 0.8s linear infinite;\n        }\n        @keyframes kairos-enc-spin {\n          to { transform: rotate(360deg); }\n        }\n      </style>\n\n      <form class="kairos-enc-form" data-kairos-enc-form>\n        <div data-kairos-enc-error class="kairos-enc-error"></div>\n\n        <div class="kairos-enc-field">\n          <label>Numero do Cartao</label>\n          <div class="kairos-enc-card-number-wrapper">\n            <input\n              type="text"\n              inputmode="numeric"\n              placeholder="0000 0000 0000 0000"\n              maxlength="19"\n              autocomplete="cc-number"\n              data-kairos-enc-card-number\n            />\n            <span class="kairos-enc-brand" data-kairos-enc-brand></span>\n          </div>\n        </div>\n\n        <div class="kairos-enc-row">\n          <div class="kairos-enc-field">\n            <label>Validade</label>\n            <input\n              type="text"\n              inputmode="numeric"\n              placeholder="MM/AA"\n              maxlength="5"\n              autocomplete="cc-exp"\n              data-kairos-enc-expiry\n            />\n          </div>\n          <div class="kairos-enc-field">\n            <label>CVV</label>\n            <input\n              type="text"\n              inputmode="numeric"\n              placeholder="123"\n              maxlength="4"\n              autocomplete="cc-csc"\n              data-kairos-enc-cvv\n            />\n          </div>\n        </div>\n\n        <div class="kairos-enc-field">\n          <label>Nome no Cartao</label>\n          <input\n            type="text"\n            placeholder="NOME COMO NO CARTAO"\n            autocomplete="cc-name"\n            data-kairos-enc-name\n          />\n        </div>\n\n        ${!1!==e.showInstallments?`\n        <div class="kairos-enc-field">\n          <label>Parcelas</label>\n          <select data-kairos-enc-installments>\n            <option value="1">1x de R$ ${n} sem juros</option>\n          </select>\n        </div>\n        `:""}\n\n        <div class="kairos-enc-security">\n          <svg class="kairos-enc-security-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>\n            <path d="m9 12 2 2 4-4"/>\n          </svg>\n          <div class="kairos-enc-security-text">\n            <strong>Pagamento Seguro</strong>\n            <span>Criptografia ponta a ponta via Kairos Payment Hub</span>\n          </div>\n          <div class="kairos-enc-security-badge">\n            <svg class="kairos-enc-security-lock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">\n              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>\n              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>\n            </svg>\n            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M12 2L2 7v10l10 5 10-5V7L12 2z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>\n      <path d="M12 7v10M8 9l4 3 4-3M8 15l4-3 4 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>\n          </div>\n        </div>\n\n        <button type="submit" class="kairos-enc-submit" data-kairos-enc-submit>\n          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>\n            <line x1="1" y1="10" x2="23" y2="10"/>\n          </svg>\n          <span>Pagar <span data-kairos-enc-amount>R$ ${n}</span></span>\n        </button>\n      </form>\n    `}}function d(e){const n=e.replace(/\D/g,"");return/^4/.test(n)?"visa":/^5[1-5]/.test(n)?"mastercard":/^3[47]/.test(n)?"amex":/^(636368|438935|504175|451416|636297)/.test(n)||/^(5067|4576|4011)/.test(n)?"elo":/^606282/.test(n)?"hipercard":""}class u{constructor(e){this.options=[],this.adapter=null,this.cardInstance=null,this.config={tenantId:e.tenantId,merchantId:e.merchantId||"",environment:e.environment||"production",apiUrl:e.apiUrl||"https://api.kairoshub.tech",preferredProvider:e.preferredProvider||void 0,locale:e.locale||"pt-BR",debug:e.debug||!1}}static async init(e){const n=new u(e);return await n.fetchOptions(),n}async fetchOptions(){const e=`${this.config.apiUrl}/api/v1/tokenization/${this.config.tenantId}/options`;this.log("Fetching tokenization options from",e);try{const n=await fetch(e);if(!n.ok)return this.log("Failed to fetch tokenization options:",n.status),void(this.options=[]);const t=await n.json();this.options=t.options||[],this.log("Available PSPs:",this.options.map(e=>e.provider))}catch(e){this.log("Error fetching tokenization options, will use Kairos encryption:",e),this.options=[]}}async getAdapter(){if(this.adapter)return this.adapter;if("KAIROS"===this.config.preferredProvider)return this.log("Using Kairos Encrypted adapter (preferred)"),this.initKairosAdapter();let e=this.options[0];if(this.config.preferredProvider){const n=this.options.find(e=>e.provider===this.config.preferredProvider);n&&(e=n)}if(!e)return this.log("No PSP with client-side tokenization available, falling back to Kairos encryption"),this.initKairosAdapter();switch(this.log("Using PSP:",e.provider),e.provider){case"MERCADOPAGO":this.adapter=new r;break;case"PAGSEGURO":this.adapter=new a;break;default:return this.log(`Unknown PSP provider "${e.provider}", falling back to Kairos encryption`),this.initKairosAdapter()}return await this.adapter.init(e.publicKey,{locale:this.config.locale,environment:e.environment}),this.adapter}async initKairosAdapter(){return this.adapter=new l,await this.adapter.init("",{apiUrl:this.config.apiUrl,tenantId:this.config.tenantId,merchantId:this.config.merchantId,locale:this.config.locale}),this.adapter}async createCardPayment(e,n){const t=await this.getAdapter();return this.log("Creating card payment form with amount:",n.amount),this.cardInstance=await t.createCardPayment(e,n),this.cardInstance}async getInstallments(e,n){return(await this.getAdapter()).getInstallments(e,n)}getAvailableProviders(){return[...this.options]}getConfig(){return{...this.config}}destroy(){this.cardInstance&&(this.cardInstance.unmount(),this.cardInstance=null),this.adapter&&(this.adapter.destroy(),this.adapter=null),this.options=[]}log(...e){this.config.debug&&console.log("[Kairos]",...e)}}const p={display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"8px 0 4px",opacity:.6},m={fontSize:"11px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:"#6b7280",letterSpacing:"0.02em"};function h(){return n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("path",{d:"M12 2L2 7v10l10 5 10-5V7L12 2z",stroke:"#6b7280",strokeWidth:"1.5",strokeLinejoin:"round"}),n.jsx("path",{d:"M12 7v10M8 9l4 3 4-3M8 15l4-3 4 3",stroke:"#6b7280",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}e.CardPaymentForm=function({tenantId:e,amount:r,environment:a="production",apiUrl:i,preferredProvider:o,maxInstallments:s=12,onSuccess:c,onError:l,onReady:d,className:y,debug:f=!1}){const g=t.useRef(null),k=t.useRef(null),[v,b]=t.useState(!0),[x,w]=t.useState(null);return t.useEffect(()=>{let n=!0;return async function(){if(g.current)try{b(!0),w(null);const t={tenantId:e,environment:a,apiUrl:i,preferredProvider:o,debug:f},p=await u.init(t);if(!n)return void p.destroy();k.current=p;const m={amount:r,maxInstallments:s,onReady:()=>{b(!1),d?.()},onSubmit:async e=>{c(e)},onError:e=>{w(e.message),l?.(e)}};await p.createCardPayment(g.current,m)}catch(e){if(n){const n=e.message||"Failed to initialize payment form";w(n),b(!1),l?.({code:"INIT_ERROR",message:n,cause:e})}}}(),()=>{n=!1,k.current&&(k.current.destroy(),k.current=null)}},[e,r,a,i,o]),n.jsxs("div",{className:y,children:[v&&n.jsxs("div",{className:"kairos-loading",children:[n.jsx("div",{className:"kairos-spinner"}),n.jsx("span",{children:"Carregando formulario de pagamento..."})]}),x&&n.jsx("div",{className:"kairos-error",children:n.jsx("span",{children:x})}),n.jsx("div",{ref:g,id:"kairos-card-payment-container",style:{display:v?"none":"block"}}),!v&&!x&&n.jsxs("div",{className:"kairos-branding",style:p,children:[n.jsx(h,{}),n.jsx("span",{style:m,children:"Powered by Kairos"})]})]})},e.KairosEncryptedAdapter=l,e.KairosPayments=u,e.VERSION="0.1.0",e.clearEncryptionCache=function(e){e?i.delete(e):i.clear()},e.encryptCardData=s,e.isEncryptionAvailable=async function(e,n,t){try{return await o(e,n,t),!0}catch{return!1}}});
//# sourceMappingURL=kairos.min.js.map
